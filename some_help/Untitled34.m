 %% initialize
clc; close all; clear all;
format shortg; format compact;


%% 
A=[0,0,0,-56.3288,0,-0.0334,0.0167,0.0167;
0,0,0,0,56.3288,0,0.0290,-.0290;
0,0,0,0,0,0.0780,0.0780,0.0780;
1,0,0,0,0,0,0,0;
0,1,0,0,0,0,0,0;
0,0,0,4576.3462,0,-0.9483,-0.0314,-0.0314;
0,0,0,-2288.2403,3963.3484,-20.2460,-37.7820,-0.0314;
0,0,0,-2288.2403,-3963.3484,-20.2460,-0.0314,-37.7820];

B=[1.3324,-0.6662,-0.6662;
    0,-1.1539,1.1539;
    -3.1076,-3.1076,-3.1076;
    0,0,0;
    0,0,0;
    -400.4479,1.2503,1.2503;
    1.2503,1505.2572,1.2503;
    1.2503,1.2503,1505.2572];
C=[0,0,0,1,0,0,0,0;
    0,0,0,0,1,0,0,0;
    0,0,1,0,0,0,0,0;
    0,0,0,0,0,1,0,0;
    0,0,0,0,0,0,1,0;
    0,0,0,0,0,0,0,1];
P=[-1 -8.01 -8.0 -37.58 -1-8i -1+8i -4.14 -37.84]
a1=ctrb(A,B)
a2=rank(a1)
b1=obsv(A,C)
b2=rank(b1)

Q=[30000 0 0 0 0 0 0 0;
    0 30000 0 0 0 0 0 0;
    0 0 30000 0 0 0 0 0;
    0 0 0 0 30000 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0]
 R=[200 0 0;
    0 200 0;
    0 0 200]
K=lqr(A,B,Q,R)